<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tau Beta Pi NU Resume E-Book</title>
  <link rel="icon" type="image/png" href="assets/logo.png">
  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
  <link rel="stylesheet" href="https://www.w3schools.com/lib/w3-theme-black.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css">
    <style>
   .circle-background {
      background-color: #f0f0f0;
      padding: 4px;
      border-radius: 50%;
      display: inline-block;
    }

    .circle-image {
      width: 200px;
      height: 200px;
      border-radius: 50%;
      object-fit: cover;
      display: block;
    }


    .container {
      display: flex;
      align-items: center; /* Align items vertically */
      justify-content: space-between; /* Space out items */
      padding: 10px;
      background-color: #f4f4f4;
      border-radius: 8px;
      max-width: 800px;
      margin: 20px auto;
    }

    .circle-background {
      display: inline-block;
      background-color: white; /* White background */
      border-radius: 50%; /* Makes it a circle */
      padding: 10px; /* Adds space around the image */
      margin: 20px;
    }

    .container img {
      width: 150px;
      height: 150px;
      border-radius: 50%;
      object-fit: cover;
    }

    .content {
      flex: 1;
    }

    .content h2 {
      margin: 0;
      font-size: 24px;
    }

    .content p {
      margin: 10px 0;
      font-size: 16px;
      color: #555;
    }

    .social-links a {
      margin-right: 10px;
      padding: 10px 15px;
      text-decoration: none;
      color: white;
      border-radius: 5px;
    }

    .social-links .linkedin { background-color: #0077b5; }

    .social-links a:hover {
      opacity: 0.8;
    }

    /* Reserve space for profiles before they load */
/* Adjust the profile container's width */
    .profile-container {
      width: 600px; /* Increased width for larger profile display */
    }

    /* Centering the profiles within the parent container */
    #profiles-container {
      min-height: 400px; /* Reserve space before profiles load */
      transition: min-height 0.5s ease; /* Smooth transition when space is removed */
      display: flex; /* Make profiles a flex container */
      flex-wrap: wrap; /* Allow wrapping for smaller screens */
      justify-content: center; /* Center the profiles */
      gap: 20px; /* Optional: Add spacing between profiles */
    }

    /* Adjust the button container to align right */
    .button-container {
      display: flex;
      justify-content: flex-end; /* Align button to the right */
    }
  </style>
</head>
<body>
<!-- Header -->
<header class="w3-container w3-indigo w3-padding" id="myHeader">
  <div class="w3-center">
    <div class="circle-background">
      <img src="assets/logo.png" alt="TBP Logo" class="circle-image" loading="lazy">
    </div>
    <h2>Tau Beta Pi Nu</h2>
    <h1 class="w3-xxxlarge">Resume E-Book</h1>
  </div>
</header>

<div class="w3-container w3-padding w3-center">
  <div class="w3-row-padding w3-center" style="display: inline-block; max-width: 100%;">
    <!-- Dropdown for selecting search category -->
    <div class="w3-col s12 m6 l6">
      <label for="search-category">Search by:</label>
      <select class="w3-select" id="search-category">
        <option value="ALL">ALL</option>
        <option value="Aerospace">Aerospace Engineering</option>
        <option value="Biomedical Engineering">Biomedical Engineering</option>
        <option value="Chemical Engineering">Chemical Engineering</option>
        <option value="Civil Engineering">Civil Engineering</option>
        <option value="Computer Engineering">Computer Engineering</option>
        <option value="Computer">Computer Science</option>
        <option value="Electrical Engineering">Electrical Engineering</option>
        <option value="Environmental Engineering">Environmental Engineering</option>
        <option value="Materials Engineering">Materials Engineering</option>
        <option value="Mechanical Engineering">Mechanical Engineering</option>
      </select>
    </div>

    <!-- Search button -->
    <div class="w3-col s12 m6 l6">
      <label>&nbsp;</label> <!-- Empty label for spacing -->
      <button class="w3-button w3-indigo w3-block" id="search-button">Search</button>
    </div>
  </div>
</div>

<!-- Profiles Section -->
<div id="profiles-container"></div>

<!-- Footer -->
<footer class="w3-container w3-indigo w3-padding-16">
  <h3>Learn more about our organization <a href="https://www.tbp.org/">here</a></h3>
  <div style="position:relative;bottom:55px;" class="w3-tooltip w3-right">
    <span class="w3-text w3-theme-light w3-padding">Go To Top</span>
    <a class="w3-text-white" href="#myHeader"><span class="w3-xlarge">
      <i class="fa fa-chevron-circle-up"></i></span></a>
  </div>
  <p>Check our socials!Â 
    <a href="https://engineering.buffalo.edu/home/academics/beyond/clubs.host.html/content/shared/engineering/school-wide-content/clubs/seas/tau-beta-pi.detail.html" class="w3-btn w3-theme-light" target="_blank">
      <i class="fa fa-graduation-cap"></i> UB Site
    </a>
    <a href="https://tbpnyn.square.site/" class="w3-btn w3-theme-light" target="_blank">
      <i class="fa fa-info"></i> TBP Website
    </a>
    <a href="https://www.instagram.com/taubetapiub/" class="w3-btn w3-theme-light" target="_blank">
      <i class="fa fa-instagram"></i> Instagram
    </a>
  </p>
</footer>

<!-- Script for creating and displaying profiles -->
<script>
  // Global variable to store parsed student data
  let studentData = [];

// Function to create a profile container
function createProfileContainer(profile) {
  // Main container with modern styling
  const container = document.createElement('div');
  container.className = 'w3-card w3-round-large';
  container.style.width = '420px';
  container.style.margin = '15px';
  container.style.overflow = 'hidden';
  container.style.transition = 'transform 0.3s, box-shadow 0.3s';
  container.style.boxShadow = '0 4px 8px rgba(0,0,0,0.1)';
  container.style.borderRadius = '12px';
  
  // Add hover effect
  container.addEventListener('mouseenter', () => {
    container.style.transform = 'translateY(-5px)';
    container.style.boxShadow = '0 8px 16px rgba(0,0,0,0.15)';
  });
  
  container.addEventListener('mouseleave', () => {
    container.style.transform = 'translateY(0)';
    container.style.boxShadow = '0 4px 8px rgba(0,0,0,0.1)';
  });

  // Header section with photo and name
  const header = document.createElement('div');
  header.style.background = 'linear-gradient(135deg, #3949ab, #5c6bc0)';
  header.style.color = 'white';
  header.style.padding = '25px 20px 65px 20px';
  header.style.position = 'relative';
  header.style.textAlign = 'center';

  // Name with improved typography
  const name = document.createElement('h3');
  name.textContent = `${profile['First Name']} ${profile['Last Name']}`;
  name.style.margin = '0 0 5px 0';
  name.style.fontWeight = '600';
  name.style.fontSize = '1.4rem';
  name.style.letterSpacing = '0.5px';
  
  // Status info
  const status = document.createElement('p');
  status.textContent = `${profile['Status'] || ""}`;
  status.style.margin = '0';
  status.style.fontSize = '0.9rem';
  status.style.opacity = '0.9';
  
  header.appendChild(name);
  header.appendChild(status);
  
  // Profile photo (overlapping header and content)
  const photoWrapper = document.createElement('div');
  photoWrapper.style.position = 'absolute';
  photoWrapper.style.bottom = '-50px';
  photoWrapper.style.left = '50%';
  photoWrapper.style.transform = 'translateX(-50%)';
  photoWrapper.style.zIndex = '10';
  photoWrapper.style.borderRadius = '50%';
  photoWrapper.style.padding = '4px';
  photoWrapper.style.background = 'white';
  photoWrapper.style.boxShadow = '0 4px 8px rgba(0,0,0,0.1)';
  
  const photo = document.createElement('img');
  photo.src = profile['Photo'] ? convertDriveLinkToThumbnail(profile['Photo']) : 'assets/default-profile.png';
  photo.alt = `${profile['First Name']} ${profile['Last Name']} Photo`;
  photo.style.width = '100px';
  photo.style.height = '100px';
  photo.style.objectFit = 'cover';
  photo.style.borderRadius = '50%';
  photo.loading = 'lazy';
  
  photoWrapper.appendChild(photo);
  header.appendChild(photoWrapper);
  
  // Content section with details
  const content = document.createElement('div');
  content.style.padding = '60px 25px 25px 25px';
  content.style.backgroundColor = 'white';
  
  // Details grid with icons
  const detailsGrid = document.createElement('div');
  detailsGrid.style.display = 'grid';
  detailsGrid.style.gridTemplateColumns = 'auto 1fr';
  detailsGrid.style.gap = '8px 12px';
  detailsGrid.style.alignItems = 'center';
  detailsGrid.style.marginBottom = '25px';
  
  // Function to add detail with icon
  const addDetailWithIcon = (iconClass, value) => {
    if (!value) return;
    
    const icon = document.createElement('i');
    icon.className = iconClass;
    icon.style.color = '#3949ab';
    icon.style.fontSize = '1rem';
    icon.style.width = '20px';
    icon.style.textAlign = 'center';
    
    const text = document.createElement('span');
    text.textContent = value;
    text.style.color = '#333';
    text.style.fontSize = '0.95rem';
    
    detailsGrid.appendChild(icon);
    detailsGrid.appendChild(text);
  };
  
  // Add details with icons
  addDetailWithIcon('fa fa-graduation-cap', profile['Major']);
  addDetailWithIcon('fa fa-users', profile['Class']);
  addDetailWithIcon('fa fa-calendar', `${profile['Grad Month'] || ""} ${profile['Grad Year'] || ""}`);
  
  content.appendChild(detailsGrid);
  
  // Social links with improved buttons
  const socialLinks = document.createElement('div');
  socialLinks.style.display = 'flex';
  socialLinks.style.justifyContent = 'center';
  socialLinks.style.gap = '12px';
  socialLinks.style.marginTop = '20px';
  
  // Function to create social button
  const createSocialButton = (href, iconClass, bgColor, label = null) => {
    const link = document.createElement('a');
    link.href = href;
    link.target = '_blank';
    link.rel = 'noopener noreferrer';
    link.style.display = 'inline-flex';
    link.style.alignItems = 'center';
    link.style.justifyContent = 'center';
    link.style.padding = label ? '8px 16px' : '10px';
    link.style.borderRadius = '50px';
    link.style.backgroundColor = bgColor;
    link.style.color = 'white';
    link.style.textDecoration = 'none';
    link.style.transition = 'all 0.3s';
    link.style.boxShadow = '0 2px 5px rgba(0,0,0,0.1)';
    
    const icon = document.createElement('i');
    icon.className = iconClass;
    icon.style.fontSize = '1rem';
    
    link.appendChild(icon);
    
    if (label) {
      const text = document.createElement('span');
      text.textContent = ` ${label}`;
      text.style.marginLeft = '5px';
      text.style.fontWeight = '500';
      link.appendChild(text);
    }
    
    link.addEventListener('mouseenter', () => {
      link.style.transform = 'translateY(-2px)';
      link.style.boxShadow = '0 4px 8px rgba(0,0,0,0.15)';
    });
    
    link.addEventListener('mouseleave', () => {
      link.style.transform = 'translateY(0)';
      link.style.boxShadow = '0 2px 5px rgba(0,0,0,0.1)';
    });
    
    return link;
  };
  
  // Add social buttons
  if (profile['CV']) {
    socialLinks.appendChild(
      createSocialButton(profile['CV'], 'fa fa-file-pdf-o', '#e53935', 'CV')
    );
  }
  
  if (profile['LinkedIn']) {
    const linkedInUrl = profile['LinkedIn'].startsWith('http') ? profile['LinkedIn'] : `https://${profile['LinkedIn']}`;
    socialLinks.appendChild(
      createSocialButton(linkedInUrl, 'fa fa-linkedin', '#0077b5')
    );
  }
  
  if (profile['GitHub']) {
    socialLinks.appendChild(
      createSocialButton(`https://github.com/${profile['GitHub']}`, 'fa fa-github', '#333')
    );
  }
  
  content.appendChild(socialLinks);
  
  // Assemble the complete profile card
  container.appendChild(header);
  container.appendChild(content);
  
  return container;
}
   

  // Function to display profiles on the page
  function displayProfiles(students) {
    const profilesContainer = document.getElementById('profiles-container');
    profilesContainer.innerHTML = ''; // Clear existing profiles

    students.forEach(student => {
      const studentProfile = createProfileContainer(student);
      profilesContainer.appendChild(studentProfile);
    });

    profilesContainer.style.minHeight = '0'; // Remove reserved space after loading profiles
  }

  // Function to load all profiles
  function loadAllProfiles() {
    displayProfiles(studentData); // Load all profiles
  }

  // Function to filter and load profiles by Major
  function loadByMajor(major) {
  // Convert search term and student major to lowercase for case-insensitive comparison
  const filteredStudents = studentData.filter(student => 
    student.Major.toLowerCase().includes(major.toLowerCase())
  );

  // Call the function to display the filtered profiles
  displayProfiles(filteredStudents);
}


  // Function to fetch and parse the CSV data
  function loadProfiles() {
    const fileUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSfJCM73_Psvd_phxPtnIGO4K1-NVuv70qkDGrFoQsMjvbfQDO-rhncld7QHSdHWg68O9XQfVJwWAZY/pub?output=csv";

    fetch(fileUrl)
      .then(response => {
        if (!response.ok) {
          throw new Error('Network response was not ok');
        }
        return response.text();
      })
      .then((data) => {
        studentData = processCSV(data); // Store parsed student data in global variable
        loadAllProfiles(); // Load all profiles initially
      })
      .catch((error) => {
        console.error('There was a problem with the fetch operation:', error);
      });
  }

  // Function to process CSV and convert to an array of objects
  function processCSV(csvText) {
    const lines = csvText.split(/\r?\n/);
    const headers = lines[0].split(',').map(header => header.trim());
    const dataLines = lines.slice(1);

    return dataLines.map(line => {
      const items = line.split(',').map(item => item.trim());
      const student = {};
      headers.forEach((header, index) => {
        student[header] = items[index] || '';
      });
      return student;
    }).filter(student => Object.keys(student).length > 1); // Filter out empty rows
  }

  function convertDriveLinkToThumbnail(url) {
    const match = url.match(/\/d\/([a-zA-Z0-9_-]+)(?:\/|$)/);
  if (match && match[1]) {
    const fileId = match[1];
    return `https://drive.google.com/thumbnail?id=${fileId}&sz=w1000`;
  }
  return url;
}


  // Add event listener to the search button
  document.getElementById('search-button').addEventListener('click', function() {
    // Get the selected value from the dropdown
    const selectedCategory = document.getElementById('search-category').value;
    // Call a function and pass the selected category
    if (selectedCategory == "ALL"){
      loadAllProfiles();
    }
    else{
      loadByMajor(selectedCategory);
    }
  });

  // Load profiles on page load
  window.addEventListener('DOMContentLoaded', loadProfiles);
</script>

</body>
</html>
